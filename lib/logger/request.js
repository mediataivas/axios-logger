'use strict';

Object.defineProperty(exports, '__esModule', {
    value: true,
});
exports.default = void 0;

var _types = require('../common/types');

var _config = require('../common/config');

var _stringBuilder = _interopRequireDefault(require('../common/string-builder'));

function _interopRequireDefault(obj) {
    return obj && obj.__esModule ? obj : { default: obj };
}

function requestLogger(request, config) {
    const { url, method, data, headers } = request;
    const buildConfig = (0, _config.assembleBuildConfig)(config);
    const requestAsAny = request;

    if (!requestAsAny.meta) {
        requestAsAny.meta = {};
    }

    requestAsAny.meta.requestStartedAt = new Date().getTime();

    if (!buildConfig.isRequestLogEnabled) {
        return request;
    }

    const stringBuilder = new _stringBuilder.default(buildConfig);
    const log = stringBuilder
        .makeLogTypeWithPrefix(_types.LOG_TYPE.REQUEST, url)
        .makeDateFormat(new Date())
        .makeMethod(method)
        .makeHeader(headers)
        .makeData(data)
        .build();
    buildConfig.logger(log);
    return request;
}

var _default = requestLogger;
exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9sb2dnZXIvcmVxdWVzdC50cyJdLCJuYW1lcyI6WyJyZXF1ZXN0TG9nZ2VyIiwicmVxdWVzdCIsImNvbmZpZyIsInVybCIsIm1ldGhvZCIsImRhdGEiLCJoZWFkZXJzIiwiYnVpbGRDb25maWciLCJyZXF1ZXN0QXNBbnkiLCJtZXRhIiwicmVxdWVzdFN0YXJ0ZWRBdCIsIkRhdGUiLCJnZXRUaW1lIiwiaXNSZXF1ZXN0TG9nRW5hYmxlZCIsInN0cmluZ0J1aWxkZXIiLCJTdHJpbmdCdWlsZGVyIiwibG9nIiwibWFrZUxvZ1R5cGVXaXRoUHJlZml4IiwiTE9HX1RZUEUiLCJSRVFVRVNUIiwibWFrZURhdGVGb3JtYXQiLCJtYWtlTWV0aG9kIiwibWFrZUhlYWRlciIsIm1ha2VEYXRhIiwiYnVpbGQiLCJsb2dnZXIiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFDQTs7QUFDQTs7QUFDQTs7OztBQUdBLFNBQVNBLGFBQVQsQ0FBdUJDLE9BQXZCLEVBQW9EQyxNQUFwRCxFQUErRTtBQUUzRSxRQUFNO0FBQUNDLElBQUFBLEdBQUQ7QUFBTUMsSUFBQUEsTUFBTjtBQUFjQyxJQUFBQSxJQUFkO0FBQW9CQyxJQUFBQTtBQUFwQixNQUErQkwsT0FBckM7QUFDQSxRQUFNTSxXQUFXLEdBQUcsaUNBQW9CTCxNQUFwQixDQUFwQjtBQUNBLFFBQU1NLFlBQVksR0FBR1AsT0FBckI7O0FBQ0EsTUFBRyxDQUFDTyxZQUFZLENBQUNDLElBQWpCLEVBQXVCO0FBQ25CRCxJQUFBQSxZQUFZLENBQUNDLElBQWIsR0FBb0IsRUFBcEI7QUFDSDs7QUFFREQsRUFBQUEsWUFBWSxDQUFDQyxJQUFiLENBQWtCQyxnQkFBbEIsR0FBcUMsSUFBSUMsSUFBSixHQUFXQyxPQUFYLEVBQXJDOztBQUVBLE1BQUksQ0FBQ0wsV0FBVyxDQUFDTSxtQkFBakIsRUFBc0M7QUFDbEMsV0FBT1osT0FBUDtBQUNIOztBQUVELFFBQU1hLGFBQWEsR0FBRyxJQUFJQyxzQkFBSixDQUFrQlIsV0FBbEIsQ0FBdEI7QUFDQSxRQUFNUyxHQUFHLEdBQUdGLGFBQWEsQ0FDcEJHLHFCQURPLENBQ2VDLGdCQUFTQyxPQUR4QixFQUNpQ2hCLEdBRGpDLEVBRVBpQixjQUZPLENBRVEsSUFBSVQsSUFBSixFQUZSLEVBR1BVLFVBSE8sQ0FHSWpCLE1BSEosRUFJUGtCLFVBSk8sQ0FJSWhCLE9BSkosRUFLUGlCLFFBTE8sQ0FLRWxCLElBTEYsRUFNUG1CLEtBTk8sRUFBWjtBQVFBakIsRUFBQUEsV0FBVyxDQUFDa0IsTUFBWixDQUFtQlQsR0FBbkI7QUFFQSxTQUFPZixPQUFQO0FBQ0g7O2VBRWNELGEiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBeGlvc1JlcXVlc3RDb25maWcgfSBmcm9tICdheGlvcyc7XG5pbXBvcnQgeyBMT0dfVFlQRSwgUmVxdWVzdExvZ0NvbmZpZyB9IGZyb20gJy4uL2NvbW1vbi90eXBlcyc7XG5pbXBvcnQgeyBhc3NlbWJsZUJ1aWxkQ29uZmlnLCBnZXRHbG9iYWxDb25maWcgfSBmcm9tICcuLi9jb21tb24vY29uZmlnJztcbmltcG9ydCBTdHJpbmdCdWlsZGVyIGZyb20gJy4uL2NvbW1vbi9zdHJpbmctYnVpbGRlcic7XG5cblxuZnVuY3Rpb24gcmVxdWVzdExvZ2dlcihyZXF1ZXN0OiBBeGlvc1JlcXVlc3RDb25maWcsIGNvbmZpZz86IFJlcXVlc3RMb2dDb25maWcpIHtcblxuICAgIGNvbnN0IHt1cmwsIG1ldGhvZCwgZGF0YSwgaGVhZGVyc30gPSByZXF1ZXN0O1xuICAgIGNvbnN0IGJ1aWxkQ29uZmlnID0gYXNzZW1ibGVCdWlsZENvbmZpZyhjb25maWcpO1xuICAgIGNvbnN0IHJlcXVlc3RBc0FueSA9IHJlcXVlc3QgYXMgYW55O1xuICAgIGlmKCFyZXF1ZXN0QXNBbnkubWV0YSkge1xuICAgICAgICByZXF1ZXN0QXNBbnkubWV0YSA9IHt9O1xuICAgIH1cblxuICAgIHJlcXVlc3RBc0FueS5tZXRhLnJlcXVlc3RTdGFydGVkQXQgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKTtcblxuICAgIGlmICghYnVpbGRDb25maWcuaXNSZXF1ZXN0TG9nRW5hYmxlZCkge1xuICAgICAgICByZXR1cm4gcmVxdWVzdDtcbiAgICB9XG5cbiAgICBjb25zdCBzdHJpbmdCdWlsZGVyID0gbmV3IFN0cmluZ0J1aWxkZXIoYnVpbGRDb25maWcpO1xuICAgIGNvbnN0IGxvZyA9IHN0cmluZ0J1aWxkZXJcbiAgICAgICAgLm1ha2VMb2dUeXBlV2l0aFByZWZpeChMT0dfVFlQRS5SRVFVRVNULCB1cmwpXG4gICAgICAgIC5tYWtlRGF0ZUZvcm1hdChuZXcgRGF0ZSgpKVxuICAgICAgICAubWFrZU1ldGhvZChtZXRob2QpXG4gICAgICAgIC5tYWtlSGVhZGVyKGhlYWRlcnMpXG4gICAgICAgIC5tYWtlRGF0YShkYXRhKVxuICAgICAgICAuYnVpbGQoKTtcblxuICAgIGJ1aWxkQ29uZmlnLmxvZ2dlcihsb2cpO1xuXG4gICAgcmV0dXJuIHJlcXVlc3Q7XG59XG5cbmV4cG9ydCBkZWZhdWx0IHJlcXVlc3RMb2dnZXI7XG4iXX0=
