'use strict';

Object.defineProperty(exports, '__esModule', {
    value: true,
});
exports.default = void 0;

var _config = require('../common/config');

var _stringBuilder = _interopRequireDefault(require('../common/string-builder'));

function _interopRequireDefault(obj) {
    return obj && obj.__esModule ? obj : { default: obj };
}

function requestLogger(request, config) {
    const { url, method, data, headers } = request;
    const buildConfig = (0, _config.assembleBuildConfig)(config);
    const requestAsAny = request;

    if (!requestAsAny.meta) {
        requestAsAny.meta = {};
    }

    requestAsAny.meta.requestStartedAt = new Date().getTime();

    if (!buildConfig.isRequestLogEnabled) {
        return request;
    }

    const stringBuilder = new _stringBuilder.default(buildConfig);
    const log = stringBuilder
        .makeLogTypeWithPrefix('Request')
        .makeDateFormat(new Date())
        .makeMethod(method)
        .makeUrl(url)
        .makeHeader(headers)
        .makeData(data)
        .build();
    buildConfig.logger(log);
    return request;
}

var _default = requestLogger;
exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9sb2dnZXIvcmVxdWVzdC50cyJdLCJuYW1lcyI6WyJyZXF1ZXN0TG9nZ2VyIiwicmVxdWVzdCIsImNvbmZpZyIsInVybCIsIm1ldGhvZCIsImRhdGEiLCJoZWFkZXJzIiwiYnVpbGRDb25maWciLCJyZXF1ZXN0QXNBbnkiLCJtZXRhIiwicmVxdWVzdFN0YXJ0ZWRBdCIsIkRhdGUiLCJnZXRUaW1lIiwiaXNSZXF1ZXN0TG9nRW5hYmxlZCIsInN0cmluZ0J1aWxkZXIiLCJTdHJpbmdCdWlsZGVyIiwibG9nIiwibWFrZUxvZ1R5cGVXaXRoUHJlZml4IiwibWFrZURhdGVGb3JtYXQiLCJtYWtlTWV0aG9kIiwibWFrZVVybCIsIm1ha2VIZWFkZXIiLCJtYWtlRGF0YSIsImJ1aWxkIiwibG9nZ2VyIl0sIm1hcHBpbmdzIjoiOzs7Ozs7O0FBRUE7O0FBQ0E7Ozs7QUFFQSxTQUFTQSxhQUFULENBQXVCQyxPQUF2QixFQUFvREMsTUFBcEQsRUFBK0U7QUFFM0UsUUFBTTtBQUFDQyxJQUFBQSxHQUFEO0FBQU1DLElBQUFBLE1BQU47QUFBY0MsSUFBQUEsSUFBZDtBQUFvQkMsSUFBQUE7QUFBcEIsTUFBK0JMLE9BQXJDO0FBQ0EsUUFBTU0sV0FBVyxHQUFHLGlDQUFvQkwsTUFBcEIsQ0FBcEI7QUFDQSxRQUFNTSxZQUFZLEdBQUdQLE9BQXJCOztBQUNBLE1BQUcsQ0FBQ08sWUFBWSxDQUFDQyxJQUFqQixFQUF1QjtBQUNuQkQsSUFBQUEsWUFBWSxDQUFDQyxJQUFiLEdBQW9CLEVBQXBCO0FBQ0g7O0FBRURELEVBQUFBLFlBQVksQ0FBQ0MsSUFBYixDQUFrQkMsZ0JBQWxCLEdBQXFDLElBQUlDLElBQUosR0FBV0MsT0FBWCxFQUFyQzs7QUFFQSxNQUFJLENBQUNMLFdBQVcsQ0FBQ00sbUJBQWpCLEVBQXNDO0FBQ2xDLFdBQU9aLE9BQVA7QUFDSDs7QUFFRCxRQUFNYSxhQUFhLEdBQUcsSUFBSUMsc0JBQUosQ0FBa0JSLFdBQWxCLENBQXRCO0FBQ0EsUUFBTVMsR0FBRyxHQUFHRixhQUFhLENBQ3BCRyxxQkFETyxDQUNlLFNBRGYsRUFFUEMsY0FGTyxDQUVRLElBQUlQLElBQUosRUFGUixFQUdQUSxVQUhPLENBR0lmLE1BSEosRUFJUGdCLE9BSk8sQ0FJQ2pCLEdBSkQsRUFLUGtCLFVBTE8sQ0FLSWYsT0FMSixFQU1QZ0IsUUFOTyxDQU1FakIsSUFORixFQU9Qa0IsS0FQTyxFQUFaO0FBU0FoQixFQUFBQSxXQUFXLENBQUNpQixNQUFaLENBQW1CUixHQUFuQjtBQUVBLFNBQU9mLE9BQVA7QUFDSDs7ZUFFY0QsYSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEF4aW9zUmVxdWVzdENvbmZpZyB9IGZyb20gJ2F4aW9zJztcbmltcG9ydCB7IFJlcXVlc3RMb2dDb25maWcgfSBmcm9tICcuLi9jb21tb24vdHlwZXMnO1xuaW1wb3J0IHsgYXNzZW1ibGVCdWlsZENvbmZpZywgZ2V0R2xvYmFsQ29uZmlnIH0gZnJvbSAnLi4vY29tbW9uL2NvbmZpZyc7XG5pbXBvcnQgU3RyaW5nQnVpbGRlciBmcm9tICcuLi9jb21tb24vc3RyaW5nLWJ1aWxkZXInO1xuXG5mdW5jdGlvbiByZXF1ZXN0TG9nZ2VyKHJlcXVlc3Q6IEF4aW9zUmVxdWVzdENvbmZpZywgY29uZmlnPzogUmVxdWVzdExvZ0NvbmZpZykge1xuXG4gICAgY29uc3Qge3VybCwgbWV0aG9kLCBkYXRhLCBoZWFkZXJzfSA9IHJlcXVlc3Q7XG4gICAgY29uc3QgYnVpbGRDb25maWcgPSBhc3NlbWJsZUJ1aWxkQ29uZmlnKGNvbmZpZyk7XG4gICAgY29uc3QgcmVxdWVzdEFzQW55ID0gcmVxdWVzdCBhcyBhbnk7XG4gICAgaWYoIXJlcXVlc3RBc0FueS5tZXRhKSB7XG4gICAgICAgIHJlcXVlc3RBc0FueS5tZXRhID0ge307XG4gICAgfVxuXG4gICAgcmVxdWVzdEFzQW55Lm1ldGEucmVxdWVzdFN0YXJ0ZWRBdCA9IG5ldyBEYXRlKCkuZ2V0VGltZSgpO1xuXG4gICAgaWYgKCFidWlsZENvbmZpZy5pc1JlcXVlc3RMb2dFbmFibGVkKSB7XG4gICAgICAgIHJldHVybiByZXF1ZXN0O1xuICAgIH1cblxuICAgIGNvbnN0IHN0cmluZ0J1aWxkZXIgPSBuZXcgU3RyaW5nQnVpbGRlcihidWlsZENvbmZpZyk7XG4gICAgY29uc3QgbG9nID0gc3RyaW5nQnVpbGRlclxuICAgICAgICAubWFrZUxvZ1R5cGVXaXRoUHJlZml4KCdSZXF1ZXN0JylcbiAgICAgICAgLm1ha2VEYXRlRm9ybWF0KG5ldyBEYXRlKCkpXG4gICAgICAgIC5tYWtlTWV0aG9kKG1ldGhvZClcbiAgICAgICAgLm1ha2VVcmwodXJsKVxuICAgICAgICAubWFrZUhlYWRlcihoZWFkZXJzKVxuICAgICAgICAubWFrZURhdGEoZGF0YSlcbiAgICAgICAgLmJ1aWxkKCk7XG5cbiAgICBidWlsZENvbmZpZy5sb2dnZXIobG9nKTtcblxuICAgIHJldHVybiByZXF1ZXN0O1xufVxuXG5leHBvcnQgZGVmYXVsdCByZXF1ZXN0TG9nZ2VyO1xuIl19
